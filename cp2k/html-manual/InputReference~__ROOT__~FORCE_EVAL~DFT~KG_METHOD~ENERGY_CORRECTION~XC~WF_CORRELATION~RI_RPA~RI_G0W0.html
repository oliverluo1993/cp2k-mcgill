<HTML><BODY>
<HEAD><TITLE> The CP2K project : input section RI_G0W0                                                                         </TITLE></HEAD>
<META NAME="description" content="CP2K">
<META NAME="keywords" contents="scientific,computing,chemistry,physics,documentation,help,manual,Fortran,parallel">
<H1> Section RI_G0W0                                                                          </H1>
 <A HREF="index.html">Index of all sections</A>. This section is located at 
<A HREF="InputReference~__ROOT__.html">__ROOT__</A>%<A HREF="InputReference~__ROOT__~FORCE_EVAL.html">FORCE_EVAL</A>%<A HREF="InputReference~__ROOT__~FORCE_EVAL~DFT.html">DFT</A>%<A HREF="InputReference~__ROOT__~FORCE_EVAL~DFT~KG_METHOD.html">KG_METHOD</A>%<A HREF="InputReference~__ROOT__~FORCE_EVAL~DFT~KG_METHOD~ENERGY_CORRECTION.html">ENERGY_CORRECTION</A>%<A HREF="InputReference~__ROOT__~FORCE_EVAL~DFT~KG_METHOD~ENERGY_CORRECTION~XC.html">XC</A>%<A HREF="InputReference~__ROOT__~FORCE_EVAL~DFT~KG_METHOD~ENERGY_CORRECTION~XC~WF_CORRELATION.html">WF_CORRELATION</A>%<A HREF="InputReference~__ROOT__~FORCE_EVAL~DFT~KG_METHOD~ENERGY_CORRECTION~XC~WF_CORRELATION~RI_RPA.html">RI_RPA</A>%<A HREF="InputReference~__ROOT__~FORCE_EVAL~DFT~KG_METHOD~ENERGY_CORRECTION~XC~WF_CORRELATION~RI_RPA~RI_G0W0.html">RI_G0W0</A>.
<BR><BR>Parameters influencing the RI-G0W0 method. This section can not be repeated.
<H2> Subsections</H2>
<UL>
<LI><A HREF="InputReference~__ROOT__~FORCE_EVAL~DFT~KG_METHOD~ENERGY_CORRECTION~XC~WF_CORRELATION~RI_RPA~RI_G0W0~PERIODIC.html">PERIODIC </A>
</UL>
<H2> Section keywords </H2>
<UL>
<LI><A HREF="#CORR_MOS_OCC">CORR_MOS_OCC </A>
<LI><A HREF="#CORR_MOS_VIRT">CORR_MOS_VIRT </A>
<LI><A HREF="#SCALING">SCALING </A>
<LI><A HREF="#NUMB_POLES">NUMB_POLES </A>
<LI><A HREF="#OMEGA_MAX_FIT">OMEGA_MAX_FIT </A>
<LI><A HREF="#STOP_CRIT">STOP_CRIT </A>
<LI><A HREF="#PRINT_FIT_ERROR">PRINT_FIT_ERROR </A>
<LI><A HREF="#MAX_ITER_FIT">MAX_ITER_FIT </A>
<LI><A HREF="#CHECK_FIT">CHECK_FIT </A>
<LI><A HREF="#CROSSING_SEARCH">CROSSING_SEARCH </A>
<LI><A HREF="#FERMI_LEVEL_OFFSET">FERMI_LEVEL_OFFSET </A>
<LI><A HREF="#EV_SC_ITER">EV_SC_ITER </A>
<LI><A HREF="#EPS_EV_SC_ITER">EPS_EV_SC_ITER </A>
<LI><A HREF="#HF_LIKE_EV_START">HF_LIKE_EV_START </A>
<LI><A HREF="#EV_SC_GW_REMOVE_NEG_VIRT_ENERGIES">EV_SC_GW_REMOVE_NEG_VIRT_ENERGIES </A>
<LI><A HREF="#PRINT_GW_DETAILS">PRINT_GW_DETAILS </A>
<LI><A HREF="#RI_SIGMA_X">RI_SIGMA_X </A>
<LI><A HREF="#RI_METRIC">RI_METRIC </A>
<LI><A HREF="#MIX_EXCHANGE">MIX_EXCHANGE </A>
<LI><A HREF="#FRACTION_EXX">FRACTION_EXX </A>
<LI><A HREF="#CONTOUR_DEF_START">CONTOUR_DEF_START </A>
<LI><A HREF="#CONTOUR_DEF_END">CONTOUR_DEF_END </A>
<LI><A HREF="#CONTOUR_DEF_OFFSET">CONTOUR_DEF_OFFSET </A>
<LI><A HREF="#PERIODIC">PERIODIC </A>
</UL>
<H2> Keyword descriptions </H2>
<TABLE>
<TR><TD WITDH="20%"><A NAME="CORR_MOS_OCC"><u>CORR_MOS_OCC</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">CORR_OCC 3
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Number of occupied MOs whose energies are corrected by RI-G0W0. Counting beginning from HOMO, e.g. 3 corrected occ. MOs correspond to correction of HOMO, HOMO-1 and HOMO-2. Numerical effort and storage of RI-G0W0 increase linearly with this number. In case you want to correct all occ. MOs, insert a number larger than the number of occ. MOs.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects an integer. Default value:  10
<TR><TD WIDTH="10%"><TD>variants: CORR_OCC<TR><TD WITDH="20%"><A NAME="CORR_MOS_VIRT"><u>CORR_MOS_VIRT</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">CORR_VIRT 3
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Number of virtual MOs whose energies are corrected by RI-G0W0. Counting beginning from LUMO, e.g. 3 corrected occ. MOs correspond to correction of LUMO, LUMO+1 and LUMO+2. Numerical effort and storage of RI-G0W0 increase linearly with this number. In case you want to correct all virt. MOs, insert a number larger than the number of virt. MOs.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects an integer. Default value:  10
<TR><TD WIDTH="10%"><TD>variants: CORR_VIRT<TR><TD WITDH="20%"><A NAME="SCALING"><u>SCALING</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">SCALING 0.2
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Set the scaling factor a for the Clenshaw-Curtis grid by hand. If SCALING < 0, a is calculated as for RI-RPA. Until now, the best choice seems to be 0.2. The grid points of the frequency grid are just multiplied by SCALING: omega_j = omega_j*Scaling.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default value:     2.0000000000000001E-01
<TR><TD WIDTH="10%"><TD>variants: A_SCALING<TR><TD WITDH="20%"><A NAME="NUMB_POLES"><u>NUMB_POLES</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">NUMB_POLES 2
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Number of poles for the fitting. Usually, two poles are sufficient.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects an integer. Default value:  2
<TR><TD WITDH="20%"><A NAME="OMEGA_MAX_FIT"><u>OMEGA_MAX_FIT</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">OMEGA_MAX_FIT 0.5
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Determines fitting range for the self-energy on the imaginary axis: [0, OMEGA_MAX_FIT] for virt orbitals, [-OMEGA_MAX_FIT,0] for occ orbitals. Unit: Hartree. Default: 0.734996 H = 20 eV.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default value:     7.3499599999999998E-01
<TR><TD WITDH="20%"><A NAME="STOP_CRIT"><u>STOP_CRIT</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">STOP_CRIT 1.0E-7
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Convergence criterion for the fit. The fitting iteration terminates, if chi^2(n+1)/chi^2(n)-1 < STOP_CRIT.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default value:     1.0000000000000001E-05
<TR><TD WIDTH="10%"><TD>variants: STOP_CRIT_1<TR><TD WITDH="20%"><A NAME="PRINT_FIT_ERROR"><u>PRINT_FIT_ERROR</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">FIT_ERROR
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Print the statistical error due to the fitting. This error in most cases is very pessimistic (e.g. can be a factor of 10 too large).</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical<TR><TD WIDTH="10%"><TD>This keyword behaves as a switch T
. Default value:  F
<TR><TD WIDTH="10%"><TD>variants: FIT_ERROR<TR><TD WITDH="20%"><A NAME="MAX_ITER_FIT"><u>MAX_ITER_FIT</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">MAX_ITER_FIT 10000
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Maximum number of iterations for the Levenberg-Marquard fit.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects an integer. Default value:  10000
<TR><TD WITDH="20%"><A NAME="CHECK_FIT"><u>CHECK_FIT</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">CHECK_FIT
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>If true, the self-energy on the imaginary axis and the fit are printedthe file self_energy_of_MO_<level>_for_imaginary_frequency.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical<TR><TD WIDTH="10%"><TD>This keyword behaves as a switch T
. Default value:  F
<TR><TD WITDH="20%"><A NAME="CROSSING_SEARCH"><u>CROSSING_SEARCH</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">CROSSING_SEARCH Z_SHOT
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Determines, how the self_energy is evaluated on the real axis.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a keyword. Default value:  Z_SHOT
<TR><TD WIDTH="10%"><TD>  valid keywords:<ul> <li><code>NONE</code>: Evaluate the correlation self-energy at the energy eigenvalue of SCF.</li>
<li><code>Z_SHOT</code>: Calculate the derivative of Sigma and out of it Z. Then extrapolate using Z.</li>
<li><code>NEWTON</code>: Make a Newton-Raphson fix point iteration.</li>
</ul><TR><TD WITDH="20%"><A NAME="FERMI_LEVEL_OFFSET"><u>FERMI_LEVEL_OFFSET</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">FERMI_LEVEL_OFFSET 1.0E-2
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Fermi level for occ. orbitals: e_HOMO + FERMI_LEVEL_OFFSET; Fermi level for virt. orbitals: e_LUMO - FERMI_LEVEL_OFFSET. In case e_homo + FERMI_LEVEL_OFFSET < e_lumo - FERMI_LEVEL_OFFSET,we set Fermi level = (e_HOMO+e_LUMO)/2</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default value:     2.0000000000000000E-02
<TR><TD WITDH="20%"><A NAME="EV_SC_ITER"><u>EV_SC_ITER</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">EV_SC_ITER 3
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Maximum number of iterations for eigenvalue self-consistency cycle. The computational effort of RPA and GW scales linearly with this number.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects an integer. Default value:  1
<TR><TD WITDH="20%"><A NAME="EPS_EV_SC_ITER"><u>EPS_EV_SC_ITER</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">EPS_EV_SC_ITER 0.00005
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Target accuracy for the eigenvalue self-consistency. If the G0W0 HOMO-LUMO gap differs by less than the target accuracy during the iteration, the eigenvalue self-consistency cycle stops. Unit: Hartree.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default unit: [], default value:     5.0000000000000002E-05
<TR><TD WITDH="20%"><A NAME="HF_LIKE_EV_START"><u>HF_LIKE_EV_START</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">HF_LIKE_EV_START
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>If true, take as input for GW/RPA corrected HF-like eigenvalues according to PRB 83, 115103 (2011), Sec. IV.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical<TR><TD WIDTH="10%"><TD>This keyword behaves as a switch T
. Default value:  F
<TR><TD WITDH="20%"><A NAME="EV_SC_GW_REMOVE_NEG_VIRT_ENERGIES"><u>EV_SC_GW_REMOVE_NEG_VIRT_ENERGIES</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">EV_SC_GW_REMOVE_NEG_VIRT_ENERGIES
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Set all GW energies of virtual orbitals which are below the HOMO to the value of the last eigenvalue-selfconsistency cycle.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical<TR><TD WIDTH="10%"><TD>This keyword behaves as a switch T
. Default value:  T
<TR><TD WIDTH="10%"><TD>variants: REMOVE_NEG<TR><TD WITDH="20%"><A NAME="PRINT_GW_DETAILS"><u>PRINT_GW_DETAILS</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">PRINT_GW_DETAILS
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>If true, prints additional information on the quasiparticle energies.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical<TR><TD WIDTH="10%"><TD>This keyword behaves as a switch T
. Default value:  F
<TR><TD WITDH="20%"><A NAME="RI_SIGMA_X"><u>RI_SIGMA_X</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">RI_SIGMA_X
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>If true, the exchange self-energy is calculated approximatively with RI. This is only recommended in case exact exchange is very costly, e.g. when using diffuse basis functions (seems not to work for periodic systems).</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical<TR><TD WIDTH="10%"><TD>This keyword behaves as a switch T
. Default value:  F
<TR><TD WITDH="20%"><A NAME="RI_METRIC"><u>RI_METRIC</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">RI_METRIC COULOMB
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Define which RI metric should be used for calculating B^P_nm needed for GW.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a keyword. Default value:  COULOMB
<TR><TD WIDTH="10%"><TD>  valid keywords:<ul> <li><code>COULOMB</code>: Use Coulomb metric.</li>
<li><code>OVERLAP</code>: Use overlap metric.</li>
</ul><TR><TD WIDTH="10%"><TD>variants: RI<TR><TD WITDH="20%"><A NAME="MIX_EXCHANGE"><u>MIX_EXCHANGE</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">MIX_EXCHANGE
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>If true, mix CP2K-HFX (EXX) based on the truncated Coulomb operator and. RI-HFX. Parameter can be used to speed up the convergence of the GW HOMO-LUMO gap of  periodic systems with the cell size.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical<TR><TD WIDTH="10%"><TD>This keyword behaves as a switch T
. Default value:  F
<TR><TD WITDH="20%"><A NAME="FRACTION_EXX"><u>FRACTION_EXX</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">FRACTION_EXX 0.21
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Mixing parameter between official CP2K-HFX (EXX) based on the truncated Coulomb operator (fraction = alpha) and the RI-HFX (fraction = 1-alpha). To be valid, set MIX_HFX TRUE. Parameter can be used to speed up the convergence of the GW HOMO-LUMO gap of periodic systems with the cell size.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default unit: [], default value:     2.0999999999999999E-01
<TR><TD WIDTH="10%"><TD>variants: ALPHA<TR><TD WITDH="20%"><A NAME="CONTOUR_DEF_START"><u>CONTOUR_DEF_START</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">CD_START 1
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Number of the lowest MO for which contour deformation (CD) is enabled and analytic continuation is disabled. If negative, CD is disabled.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects an integer. Default value:  -1
<TR><TD WIDTH="10%"><TD>variants: CD_START<TR><TD WITDH="20%"><A NAME="CONTOUR_DEF_END"><u>CONTOUR_DEF_END</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">CD_END 100
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Number of the highest MO for which contour deformation (CD) is enabled and analytic continuation is disabled. If negative, CD is disabled.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects an integer. Default value:  -1
<TR><TD WIDTH="10%"><TD>variants: CD_END<TR><TD WITDH="20%"><A NAME="CONTOUR_DEF_OFFSET"><u>CONTOUR_DEF_OFFSET</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">CONTOUR_DEF_OFFSET 1.0E-2
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Offset for computing the Z-factor in the contour deformation technique.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default value:     2.0000000000000000E-02
<TR><TD WIDTH="10%"><TD>variants: CD_OFFSET<TR><TD WITDH="20%"><A NAME="PERIODIC"><u>PERIODIC</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">PERIODIC
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>If true, the periodic correction scheme is used employing k-points. Specify the k-point mesh in a following k-point section. Only works with RI OVERLAP (RI OVERLAP has to be set twice!).</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical<TR><TD WIDTH="10%"><TD>This keyword behaves as a switch T
. Default value:  F
</TABLE>
<BR><hr>Back to the <A HREF="https://www.cp2k.org/">CP2K homepage</A> or the latest version of <A HREF="https://manual.cp2k.org/trunk/">this manual</A>
</BODY></HTML>
