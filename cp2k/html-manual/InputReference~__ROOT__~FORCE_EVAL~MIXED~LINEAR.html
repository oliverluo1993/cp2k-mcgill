<HTML><BODY>
<HEAD><TITLE> The CP2K project : input section LINEAR                                                                          </TITLE></HEAD>
<META NAME="description" content="CP2K">
<META NAME="keywords" contents="scientific,computing,chemistry,physics,documentation,help,manual,Fortran,parallel">
<H1> Section LINEAR                                                                           </H1>
 <A HREF="index.html">Index of all sections</A>. This section is located at 
<A HREF="InputReference~__ROOT__.html">__ROOT__</A>%<A HREF="InputReference~__ROOT__~FORCE_EVAL.html">FORCE_EVAL</A>%<A HREF="InputReference~__ROOT__~FORCE_EVAL~MIXED.html">MIXED</A>%<A HREF="InputReference~__ROOT__~FORCE_EVAL~MIXED~LINEAR.html">LINEAR</A>.
<BR><BR>Linear combination between two force_eval:  F= lambda F1 + (1-lambda) F2. This section can not be repeated.
<H2> Subsections</H2>
None
<H2> Section keywords </H2>
<UL>
<LI><A HREF="#LAMBDA">LAMBDA </A>
<LI><A HREF="#MIXED_CDFT">MIXED_CDFT </A>
<LI><A HREF="#MIXED_CDFT_COUPLING">MIXED_CDFT_COUPLING </A>
<LI><A HREF="#MIXED_CDFT_DLB">MIXED_CDFT_DLB </A>
<LI><A HREF="#MIXED_CDFT_METRIC">MIXED_CDFT_METRIC </A>
<LI><A HREF="#MIXED_CDFT_WFN_OVERLAP">MIXED_CDFT_WFN_OVERLAP </A>
<LI><A HREF="#MIXED_CDFT_LOWDIN">MIXED_CDFT_LOWDIN </A>
<LI><A HREF="#MIXED_CDFT_CI">MIXED_CDFT_CI </A>
<LI><A HREF="#WFN_RESTART_FILE_NAME">WFN_RESTART_FILE_NAME </A>
<LI><A HREF="#EPS_SVD">EPS_SVD </A>
<LI><A HREF="#LOAD_SCALE">LOAD_SCALE </A>
<LI><A HREF="#MORE_WORK">MORE_WORK </A>
<LI><A HREF="#VERY_OVERLOADED">VERY_OVERLOADED </A>
</UL>
<H2> Keyword descriptions </H2>
<TABLE>
<TR><TD WITDH="20%"><A NAME="LAMBDA"><u>LAMBDA</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">lambda <REAL>
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Specify the mixing parameter lambda in the formula.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real<TR><TD WITDH="20%"><A NAME="MIXED_CDFT"><u>MIXED_CDFT</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">MIXED_CDFT
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Controls the activation of a mixed CDFT calculation. The two force_evals determine the involved CDFT states (requires the corresponding sections).</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical<TR><TD WIDTH="10%"><TD>This keyword behaves as a switch T
. Default value:  F
<BR> This keyword cites following reference: 
<A HREF="references.html#reference_178" TITLE="
 Holmberg, N; Laasonen, K. 
 Journal of Chemical Theory and Computation, 13 (2), (2017). 
 Efficient Constrained Density Functional Theory Implementation for Simulation of
 Condensed Phase Electron Transfer Reactions.
 http://dx.doi.org/10.1021/acs.jctc.6b01085
">[Holmberg2017]</A>
<TR><TD WITDH="20%"><A NAME="MIXED_CDFT_COUPLING"><u>MIXED_CDFT_COUPLING</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">MIXED_CDFT_COUPLING <INT>
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Parameter determining how often the CDFT electronic coupling element is calculated. Use a negative number to disable and 0 means every step. By default, the coupling is calculated by rotating the CDFT states to eigenstates of the weight function matrix when a single constraint is active. With multiple constraints, uses Lowdin orthogonalization.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects an integer. Default value:  -1
<TR><TD WITDH="20%"><A NAME="MIXED_CDFT_DLB"><u>MIXED_CDFT_DLB</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">MIXED_CDFT_DLB
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Controls the activation of dynamic load balancing during a mixed CDFT calculation. Requires Gaussian cavity confinement.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical<TR><TD WIDTH="10%"><TD>This keyword behaves as a switch T
. Default value:  F
<TR><TD WITDH="20%"><A NAME="MIXED_CDFT_METRIC"><u>MIXED_CDFT_METRIC</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">MIXED_CDFT_METRIC
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Compute reliability metric for the CDFT electronic coupling element by diagonalizingthe difference density matrix.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical<TR><TD WIDTH="10%"><TD>This keyword behaves as a switch T
. Default value:  F
<BR> This keyword cites following reference: 
<A HREF="references.html#reference_176" TITLE="
 Mavros, MG;  Van Voorhis, T. 
 The Journal of Chemical Physics, 143 (23), (2015). 
 Communication: CDFT-CI couplings can be unreliable when there is fractional charge transfer.
 http://dx.doi.org/10.1063/1.4938103
">[Mavros2015]</A>
<TR><TD WITDH="20%"><A NAME="MIXED_CDFT_WFN_OVERLAP"><u>MIXED_CDFT_WFN_OVERLAP</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">MIXED_CDFT_WFN_OVERLAP
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Compute CDFT electronic coupling element using the wavefunction overlap method in addition to the standard method defined by the keyword MIXED_CDFT_COUPLING. In this method, the unconstrained KS ground state wavefunction (WFN_RESTART_FILE_NAME) is represented as a linear combination of the two CDFT states.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical<TR><TD WIDTH="10%"><TD>This keyword behaves as a switch T
. Default value:  F
<BR> This keyword cites following reference: 
<A HREF="references.html#reference_175" TITLE="
 Migliore, A. The Journal of Chemical Physics, 131 (11), (2009). 
 Full-electron calculation of effective electronic couplings and.
 http://dx.doi.org/10.1063/1.3232007
">[Migliore2009]</A>
<TR><TD WITDH="20%"><A NAME="MIXED_CDFT_LOWDIN"><u>MIXED_CDFT_LOWDIN</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">MIXED_CDFT_LOWDIN
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Compute CDFT electronic coupling element using Lowdin orthogonalization. This is the default behavior with multiple constraints. By activating this keyword, this method is also used to compute the the coupling when a single constraint is active in addition to the standard method.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical<TR><TD WIDTH="10%"><TD>This keyword behaves as a switch T
. Default value:  F
<TR><TD WITDH="20%"><A NAME="MIXED_CDFT_CI"><u>MIXED_CDFT_CI</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">MIXED_CDFT_LOWDIN
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Perform a CDFT configuration interaction calculation (CDFT-CI). The CI vector is expanded in the basis of the CDFT states. Diagonalizes the nonorthogonal diabatic CDFT Hamiltonian. The energies and expansion coefficients of the CDFT-CI states are outputted. Keyword MIXED_CDFT_COUPLING must be active to use this feature.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical<TR><TD WIDTH="10%"><TD>This keyword behaves as a switch T
. Default value:  F
<TR><TD WITDH="20%"><A NAME="WFN_RESTART_FILE_NAME"><u>WFN_RESTART_FILE_NAME</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">WFN_RESTART_FILE_NAME <FILENAME>
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Name of the wavefunction restart file that defines the unconstrained KS ground state, which is used to compute the electronic coupling with the wavefunction overlap method. May include a path.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a string<TR><TD WITDH="20%"><A NAME="EPS_SVD"><u>EPS_SVD</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">EPS_SVD <REAL>
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Determines the matrix inversion solver needed by to compute the coupling. Default value implies LU decomposition, while values between 0.0 and 1.0 imply SVD decomposition. For SVD, the value acts as a threshold for screening singular values so that only values above it are included in the matrix pseudoinverse.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default value:     0.0000000000000000E+00
<TR><TD WITDH="20%"><A NAME="LOAD_SCALE"><u>LOAD_SCALE</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">LOAD_SCALE <REAL>
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Control parameter for dynamic load balancing during a mixed CDFT calculation. See code for details.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default value:     2.0000000000000000E+00
<TR><TD WITDH="20%"><A NAME="MORE_WORK"><u>MORE_WORK</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">MORE_WORK <INT>
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Control parameter for dynamic load balancing during a mixed CDFT calculation. See code for details.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects an integer. Default value:  0
<TR><TD WITDH="20%"><A NAME="VERY_OVERLOADED"><u>VERY_OVERLOADED</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">VERY_OVERLOADED <REAL>
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Control parameter for dynamic load balancing during a mixed CDFT calculation. See code for details.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default value:     0.0000000000000000E+00
</TABLE>
<BR><hr>Back to the <A HREF="https://www.cp2k.org/">CP2K homepage</A> or the latest version of <A HREF="https://manual.cp2k.org/trunk/">this manual</A>
</BODY></HTML>
