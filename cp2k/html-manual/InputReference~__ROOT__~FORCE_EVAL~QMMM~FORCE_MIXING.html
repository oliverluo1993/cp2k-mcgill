<HTML><BODY>
<HEAD><TITLE> The CP2K project : input section FORCE_MIXING                                                                    </TITLE></HEAD>
<META NAME="description" content="CP2K">
<META NAME="keywords" contents="scientific,computing,chemistry,physics,documentation,help,manual,Fortran,parallel">
<H1> Section FORCE_MIXING                                                                     </H1>
 <A HREF="index.html">Index of all sections</A>. This section is located at 
<A HREF="InputReference~__ROOT__.html">__ROOT__</A>%<A HREF="InputReference~__ROOT__~FORCE_EVAL.html">FORCE_EVAL</A>%<A HREF="InputReference~__ROOT__~FORCE_EVAL~QMMM.html">QMMM</A>%<A HREF="InputReference~__ROOT__~FORCE_EVAL~QMMM~FORCE_MIXING.html">FORCE_MIXING</A>.
<BR><BR>This section enables and defines parameters for force-mixing based QM/MM, which actually does two conventional QM/MM calculations, on a small  and a large QM region, and combines the MM forces from one and QM  forces from the other to create a complete set of forces.  Energy is  not conserved (although the QM/MM energy from the large QM region calculation is reported)  so a proper thermostat (i.e. massive, and able to handle dissipation, such as  Adaptive Langevin (AD_LANGEVIN)) must be used. For some propagation algorithms  (NVT and REFTRAJ MD ensembles) algorithm is adaptive,  including molecules hysteretically based on their instantaneous distance from the core region.  Information on core/QM/buffer labels can be written in PDB file using  MOTION&PRINT&FORCE_MIXING_LABELS.  Will fail if calculation requires a  meaningfull stress, or an energy that is consistent with the forces.  For GEO_OPT this means  only MOTION&GEO_OPT&TYPE CG, MOTION&GEO_OPT&CG&LINE_SEARCH&TYPE 2PNT, and  MOTION&GEO_OPT&CG&LINE_SEARCH&2PNT&LINMIN_GRAD_ONLY T. This section can not be repeated.
<BR><BR> This section cites following references: 
<A HREF="references.html#reference_109" TITLE="
 Bernstein, N; Kermode, J R; Csanyi, G. 
 REPORTS ON PROGRESS IN PHYSICS, 72 (2), 026501 (2009). 
 Hybrid atomistic simulation methods for materials systems.
 http://dx.doi.org/10.1088/0034-4885/72/2/026501
">[Bernstein2009]</A>
<A HREF="references.html#reference_108" TITLE="
 Bernstein, Noam; Varnai, Csilla; Solt, Ivan; Winfield, Steven A;
 Payne, Mike C; Simon, Istvan; Fuxreiter, Monika; Csanyi, Gabor. 
 PHYSICAL CHEMISTRY CHEMICAL PHYSICS, 14 (2), 646-656 (2012). 
 QM/MM simulation of liquid water with an adaptive quantum region.
 http://dx.doi.org/10.1039/c1cp22600b
">[Bernstein2012]</A>
<H2> Subsections</H2>
<UL>
<LI><A HREF="InputReference~__ROOT__~FORCE_EVAL~QMMM~FORCE_MIXING~QM_NON_ADAPTIVE.html">QM_NON_ADAPTIVE </A>
<LI><A HREF="InputReference~__ROOT__~FORCE_EVAL~QMMM~FORCE_MIXING~BUFFER_NON_ADAPTIVE.html">BUFFER_NON_ADAPTIVE </A>
<LI><A HREF="InputReference~__ROOT__~FORCE_EVAL~QMMM~FORCE_MIXING~BUFFER_LINKS.html">BUFFER_LINKS </A>
<LI><A HREF="InputReference~__ROOT__~FORCE_EVAL~QMMM~FORCE_MIXING~RESTART_INFO.html">RESTART_INFO </A>
<LI><A HREF="InputReference~__ROOT__~FORCE_EVAL~QMMM~FORCE_MIXING~PRINT.html">PRINT </A>
</UL>
<H2> Section keywords </H2>
<UL>
<LI><A HREF="#_SECTION_PARAMETERS_">_SECTION_PARAMETERS_ </A>
<LI><A HREF="#MOMENTUM_CONSERVATION_TYPE">MOMENTUM_CONSERVATION_TYPE </A>
<LI><A HREF="#MOMENTUM_CONSERVATION_REGION">MOMENTUM_CONSERVATION_REGION </A>
<LI><A HREF="#R_CORE">R_CORE </A>
<LI><A HREF="#R_QM">R_QM </A>
<LI><A HREF="#QM_EXTENDED_SEED_IS_ONLY_CORE_LIST">QM_EXTENDED_SEED_IS_ONLY_CORE_LIST </A>
<LI><A HREF="#R_BUF">R_BUF </A>
<LI><A HREF="#QM_KIND_ELEMENT_MAPPING">QM_KIND_ELEMENT_MAPPING </A>
<LI><A HREF="#MAX_N_QM">MAX_N_QM </A>
<LI><A HREF="#ADAPTIVE_EXCLUDE_MOLECULES">ADAPTIVE_EXCLUDE_MOLECULES </A>
<LI><A HREF="#EXTENDED_DELTA_CHARGE">EXTENDED_DELTA_CHARGE </A>
</UL>
<H2> Keyword descriptions </H2>
<TABLE>
<TR><TD WITDH="20%"><A NAME="_SECTION_PARAMETERS_"><u>_SECTION_PARAMETERS_</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Enables force-mixing</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical<TR><TD WIDTH="10%"><TD>This keyword behaves as a switch T
. Default value:  F
<TR><TD WITDH="20%"><A NAME="MOMENTUM_CONSERVATION_TYPE"><u>MOMENTUM_CONSERVATION_TYPE</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">MOMENTUM_CONSERVATION_TYPE <type>
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>How to apply force to get momentum conservation</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a keyword. Default value:  EQUAL_A
<TR><TD WIDTH="10%"><TD>  valid keywords:<ul> <li><code>NONE</code>: No momentum conservation</li>
<li><code>EQUAL_F</code>: Equal force on each atom</li>
<li><code>EQUAL_A</code>: Equal acceleration on each atom</li>
</ul><TR><TD WITDH="20%"><A NAME="MOMENTUM_CONSERVATION_REGION"><u>MOMENTUM_CONSERVATION_REGION</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">MOMENTUM_CONSERVATION_REGION <label>
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Region to apply correction force to for momentum conservation</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a keyword. Default value:  QM
<TR><TD WIDTH="10%"><TD>  valid keywords:<ul> <li><code>CORE</code>: Apply to QM core region</li>
<li><code>QM</code>: Apply to full QM (dynamics) region</li>
<li><code>BUFFER</code>: Apply to QM+buffer regions</li>
</ul><TR><TD WITDH="20%"><A NAME="R_CORE"><u>R_CORE</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">R_CORE <real> <real>
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Specify the inner and outer radii of core QM region.  All molecules with any atoms within this distance (hysteretically) of any atoms  specified as QM in enclosing QM/MM section  will be core QM atoms in the force-mixing calculation.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects precisely     2 reals. Default unit: [angstrom], default value:     0.0000000000000000E+00    0.0000000000000000E+00
angstrom<TR><TD WITDH="20%"><A NAME="R_QM"><u>R_QM</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">R_QM <real> <real>
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Specify the inner and outer radii of QM dynamics region.  All molecules with atoms within this distance (hysteretically) of any atoms in  core will follow QM dynamics in the force-mixing calculation.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects precisely     2 reals. Default unit: [angstrom], default value:     5.0000000000000000E-01    1.0000000000000000E+00
angstrom<TR><TD WITDH="20%"><A NAME="QM_EXTENDED_SEED_IS_ONLY_CORE_LIST"><u>QM_EXTENDED_SEED_IS_ONLY_CORE_LIST</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">QM_EXTENDED_SEED_IS_ONLY_CORE_LIST <logical>
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Makes the extended QM zone be defined hysterestically  by distance from QM core list (i.e. atoms specified explicitly by  user) instead of from full QM core region (specified by user + hysteretic  selection + unbreakable bonds)</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical. Default value:  F
<TR><TD WITDH="20%"><A NAME="R_BUF"><u>R_BUF</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">R_BUF <real> <real>
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Specify the inner and outer radii of buffer region.  All atoms within this distance (hysteretically) of any QM atoms  will be buffer atoms in the force-mixing calculation.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects precisely     2 reals. Default unit: [angstrom], default value:     5.0000000000000000E-01    1.0000000000000000E+00
angstrom<TR><TD WITDH="20%"><A NAME="QM_KIND_ELEMENT_MAPPING"><u>QM_KIND_ELEMENT_MAPPING</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">QM_KIND_ELEMENT_MAPPING {El} {QM_KIND}
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Mapping from elements to QM_KINDs for adaptively included atoms.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects precisely     2 words, and may repeat<TR><TD WITDH="20%"><A NAME="MAX_N_QM"><u>MAX_N_QM</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">MAX_N_QM int
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Maximum number of QM atoms, for detection of runaway adaptive selection.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects an integer. Default value:  300
<TR><TD WITDH="20%"><A NAME="ADAPTIVE_EXCLUDE_MOLECULES"><u>ADAPTIVE_EXCLUDE_MOLECULES</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">ADAPTIVE_EXCLUDE_MOLECULES molec1 molec2 ...
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>List of molecule names to exclude from adaptive regions (e.g. big things like proteins)</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a list of words<TR><TD WITDH="20%"><A NAME="EXTENDED_DELTA_CHARGE"><u>EXTENDED_DELTA_CHARGE</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">EXTENDED_DELTA_CHARGE q
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Additional net charge in extended region relative to core (core charge is  specified in DFT section, as usual for a convetional QM/MM calculation)</i>
<TR><TD WIDTH="10%"><TD> This keyword expects an integer. Default value:  0
</TABLE>
<BR><hr>Back to the <A HREF="https://www.cp2k.org/">CP2K homepage</A> or the latest version of <A HREF="https://manual.cp2k.org/trunk/">this manual</A>
</BODY></HTML>
