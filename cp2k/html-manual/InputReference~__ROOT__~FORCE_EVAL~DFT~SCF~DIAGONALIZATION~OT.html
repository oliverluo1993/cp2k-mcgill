<HTML><BODY>
<HEAD><TITLE> The CP2K project : input section OT                                                                              </TITLE></HEAD>
<META NAME="description" content="CP2K">
<META NAME="keywords" contents="scientific,computing,chemistry,physics,documentation,help,manual,Fortran,parallel">
<H1> Section OT                                                                               </H1>
 <A HREF="index.html">Index of all sections</A>. This section is located at 
<A HREF="InputReference~__ROOT__.html">__ROOT__</A>%<A HREF="InputReference~__ROOT__~FORCE_EVAL.html">FORCE_EVAL</A>%<A HREF="InputReference~__ROOT__~FORCE_EVAL~DFT.html">DFT</A>%<A HREF="InputReference~__ROOT__~FORCE_EVAL~DFT~SCF.html">SCF</A>%<A HREF="InputReference~__ROOT__~FORCE_EVAL~DFT~SCF~DIAGONALIZATION.html">DIAGONALIZATION</A>%<A HREF="InputReference~__ROOT__~FORCE_EVAL~DFT~SCF~DIAGONALIZATION~OT.html">OT</A>.
<BR><BR>Sets the various options for the orbital transformation (OT) method. Default settings already provide an efficient, yet robust method. Most systems benefit from using the FULL_ALL preconditioner combined with a small value (0.001) of ENERGY_GAP. Well-behaved systems might benefit from using a DIIS minimizer. <u>Advantages:</u> It's fast, because no expensive diagonalisation is performed. If preconditioned correctly, method guaranteed to find minimum. <u>Disadvantages:</u> Sensitive to preconditioning. A good preconditioner can be expensive. No smearing, or advanced SCF mixing possible: POOR convergence for metalic systems. This section can not be repeated.
<BR><BR> This section cites following references: 
<A HREF="references.html#reference_39" TITLE="
 VandeVondele, J; Hutter, J. 
 JOURNAL OF CHEMICAL PHYSICS, 118 (10), 4365-4369 (2003). 
 An efficient orbital transformation method for electronic structure
 calculations.
 http://dx.doi.org/10.1063/1.1543154
">[VandeVondele2003]</A>
<A HREF="references.html#reference_20" TITLE="
 Weber, V; VandeVondele, J; Hutter, J; Niklasson, AMN. 
 JOURNAL OF CHEMICAL PHYSICS, 128 (8), 084113 (2008). 
 Direct energy functional minimization under orthogonality constraints.
 http://dx.doi.org/10.1063/1.2841077
">[Weber2008]</A>
<H2> Subsections</H2>
None
<H2> Section keywords </H2>
<UL>
<LI><A HREF="#_SECTION_PARAMETERS_">_SECTION_PARAMETERS_ </A>
<LI><A HREF="#ALGORITHM">ALGORITHM </A>
<LI><A HREF="#IRAC_DEGREE">IRAC_DEGREE </A>
<LI><A HREF="#MAX_IRAC">MAX_IRAC </A>
<LI><A HREF="#ORTHO_IRAC">ORTHO_IRAC </A>
<LI><A HREF="#EPS_IRAC_FILTER_MATRIX">EPS_IRAC_FILTER_MATRIX </A>
<LI><A HREF="#EPS_IRAC">EPS_IRAC </A>
<LI><A HREF="#EPS_IRAC_QUICK_EXIT">EPS_IRAC_QUICK_EXIT </A>
<LI><A HREF="#EPS_IRAC_SWITCH">EPS_IRAC_SWITCH </A>
<LI><A HREF="#ON_THE_FLY_LOC">ON_THE_FLY_LOC </A>
<LI><A HREF="#MINIMIZER">MINIMIZER </A>
<LI><A HREF="#SAFE_DIIS">SAFE_DIIS </A>
<LI><A HREF="#N_HISTORY_VEC">N_HISTORY_VEC </A>
<LI><A HREF="#BROYDEN_BETA">BROYDEN_BETA </A>
<LI><A HREF="#BROYDEN_GAMMA">BROYDEN_GAMMA </A>
<LI><A HREF="#BROYDEN_SIGMA">BROYDEN_SIGMA </A>
<LI><A HREF="#BROYDEN_ETA">BROYDEN_ETA </A>
<LI><A HREF="#BROYDEN_OMEGA">BROYDEN_OMEGA </A>
<LI><A HREF="#BROYDEN_SIGMA_DECREASE">BROYDEN_SIGMA_DECREASE </A>
<LI><A HREF="#BROYDEN_SIGMA_MIN">BROYDEN_SIGMA_MIN </A>
<LI><A HREF="#BROYDEN_FORGET_HISTORY">BROYDEN_FORGET_HISTORY </A>
<LI><A HREF="#BROYDEN_ADAPTIVE_SIGMA">BROYDEN_ADAPTIVE_SIGMA </A>
<LI><A HREF="#BROYDEN_ENABLE_FLIP">BROYDEN_ENABLE_FLIP </A>
<LI><A HREF="#LINESEARCH">LINESEARCH </A>
<LI><A HREF="#STEPSIZE">STEPSIZE </A>
<LI><A HREF="#GOLD_TARGET">GOLD_TARGET </A>
<LI><A HREF="#PRECONDITIONER">PRECONDITIONER </A>
<LI><A HREF="#CHOLESKY">CHOLESKY </A>
<LI><A HREF="#PRECOND_SOLVER">PRECOND_SOLVER </A>
<LI><A HREF="#ENERGY_GAP">ENERGY_GAP </A>
<LI><A HREF="#EPS_TAYLOR">EPS_TAYLOR </A>
<LI><A HREF="#MAX_TAYLOR">MAX_TAYLOR </A>
<LI><A HREF="#ROTATION">ROTATION </A>
<LI><A HREF="#ENERGIES">ENERGIES </A>
<LI><A HREF="#OCCUPATION_PRECONDITIONER">OCCUPATION_PRECONDITIONER </A>
<LI><A HREF="#NONDIAG_ENERGY">NONDIAG_ENERGY </A>
<LI><A HREF="#NONDIAG_ENERGY_STRENGTH">NONDIAG_ENERGY_STRENGTH </A>
</UL>
<H2> Keyword descriptions </H2>
<TABLE>
<TR><TD WITDH="20%"><A NAME="_SECTION_PARAMETERS_"><u>_SECTION_PARAMETERS_</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">&OT T
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>controls the activation of the ot method</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical<TR><TD WIDTH="10%"><TD>This keyword behaves as a switch T
. Default value:  F
<TR><TD WITDH="20%"><A NAME="ALGORITHM"><u>ALGORITHM</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">ALGORITHM STRICT
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Algorithm to be used for OT</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a keyword. Default value:  STRICT
<TR><TD WIDTH="10%"><TD>  valid keywords:<ul> <li><code>STRICT</code>: Strict orthogonality: Taylor or diagonalization based algorithm.</li>
<li><code>IRAC</code>: Orbital Transformation based Iterative Refinement of the Approximative Congruence transformation (OT/IR).</li>
</ul><BR> This keyword cites following references: 
<A HREF="references.html#reference_39" TITLE="
 VandeVondele, J; Hutter, J. 
 JOURNAL OF CHEMICAL PHYSICS, 118 (10), 4365-4369 (2003). 
 An efficient orbital transformation method for electronic structure
 calculations.
 http://dx.doi.org/10.1063/1.1543154
">[VandeVondele2003]</A>
<A HREF="references.html#reference_38" TITLE="
 VandeVondele, J; Krack, M; Mohamed, F; Parrinello, M; Chassaing, T;
 Hutter, J. COMPUTER PHYSICS COMMUNICATIONS, 167 (2), 103-128 (2005). 
 QUICKSTEP: Fast and accurate density functional calculations using a
 mixed Gaussian and plane waves approach.
 http://dx.doi.org/10.1016/j.cpc.2004.12.014
">[VandeVondele2005]</A>
<A HREF="references.html#reference_20" TITLE="
 Weber, V; VandeVondele, J; Hutter, J; Niklasson, AMN. 
 JOURNAL OF CHEMICAL PHYSICS, 128 (8), 084113 (2008). 
 Direct energy functional minimization under orthogonality constraints.
 http://dx.doi.org/10.1063/1.2841077
">[Weber2008]</A>
<TR><TD WITDH="20%"><A NAME="IRAC_DEGREE"><u>IRAC_DEGREE</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">IRAC_DEGREE 4
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>The refinement polynomial degree (2, 3 or 4).</i>
<TR><TD WIDTH="10%"><TD> This keyword expects an integer. Default value:  4
<TR><TD WITDH="20%"><A NAME="MAX_IRAC"><u>MAX_IRAC</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">MAX_IRAC 5
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Maximum allowed refinement iteration.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects an integer. Default value:  50
<TR><TD WITDH="20%"><A NAME="ORTHO_IRAC"><u>ORTHO_IRAC</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">ORTHO_IRAC POLY
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>The orthogonality method.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a keyword. Default value:  CHOL
<TR><TD WIDTH="10%"><TD>  valid keywords:<ul> <li><code>CHOL</code>: Cholesky.</li>
<li><code>POLY</code>: Polynomial.</li>
<li><code>LWDN</code>: Loewdin.</li>
</ul><TR><TD WITDH="20%"><A NAME="EPS_IRAC_FILTER_MATRIX"><u>EPS_IRAC_FILTER_MATRIX</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">EPS_IRAC_FILTER_MATRIX 1.0E-5
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Sets the threshold for filtering the matrices.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default value:     0.0000000000000000E+00
<TR><TD WITDH="20%"><A NAME="EPS_IRAC"><u>EPS_IRAC</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">EPS_IRAC 1.0E-5
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Targeted accuracy during the refinement iteration.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default value:     1.0000000000000000E-10
<TR><TD WITDH="20%"><A NAME="EPS_IRAC_QUICK_EXIT"><u>EPS_IRAC_QUICK_EXIT</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">EPS_IRAC_QUICK_EXIT 1.0E-2
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Only one extra refinement iteration is done when the norm is below this value.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default value:     1.0000000000000001E-05
<TR><TD WITDH="20%"><A NAME="EPS_IRAC_SWITCH"><u>EPS_IRAC_SWITCH</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">EPS_IRAC_SWITCH 1.0E-3
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>The algorithm switches to the polynomial refinement when the norm is below this value.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default value:     1.0000000000000000E-02
<TR><TD WITDH="20%"><A NAME="ON_THE_FLY_LOC"><u>ON_THE_FLY_LOC</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">ON_THE_FLY_LOC T
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>On the fly localization of the molecular orbitals. Can only be used with OT/IRAC.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical. Default value:  F
<TR><TD WITDH="20%"><A NAME="MINIMIZER"><u>MINIMIZER</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">MINIMIZER DIIS
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Minimizer to be used with the OT method</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a keyword. Default value:  CG
<TR><TD WIDTH="10%"><TD>  valid keywords:<ul> <li><code>SD</code>: Steepest descent: not recommended</li>
<li><code>CG</code>: Conjugate Gradients: most reliable, use for difficult systems. The total energy should decrease at every OT CG step if the line search is appropriate.</li>
<li><code>DIIS</code>: Direct inversion in the iterative subspace: less reliable than CG, but sometimes about 50% faster</li>
<li><code>BROYDEN</code>: Broyden mixing approximating the inverse Hessian</li>
</ul><TR><TD WITDH="20%"><A NAME="SAFE_DIIS"><u>SAFE_DIIS</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">SAFE_DIIS ON
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Reject DIIS steps if they point away from the minimum, do SD in that case.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical. Default value:  T
<TR><TD WIDTH="10%"><TD>variants: SAFER_DIIS<TR><TD WITDH="20%"><A NAME="N_HISTORY_VEC"><u>N_HISTORY_VEC</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">N_DIIS 4
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Number of history vectors to be used with DIIS or BROYDEN</i>
<TR><TD WIDTH="10%"><TD> This keyword expects an integer. Default value:  7
<TR><TD WIDTH="10%"><TD>variants: NDIIS, N_DIIS, N_BROYDEN<TR><TD WITDH="20%"><A NAME="BROYDEN_BETA"><u>BROYDEN_BETA</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">BROYDEN_BETA 0.9
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Underrelaxation for the broyden mixer</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default value:     9.0000000000000002E-01
<TR><TD WITDH="20%"><A NAME="BROYDEN_GAMMA"><u>BROYDEN_GAMMA</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">BROYDEN_GAMMA 0.5
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Backtracking parameter</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default value:     5.0000000000000000E-01
<TR><TD WITDH="20%"><A NAME="BROYDEN_SIGMA"><u>BROYDEN_SIGMA</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">BROYDEN_SIGMA 0.25
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Curvature of energy functional.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default value:     2.5000000000000000E-01
<TR><TD WITDH="20%"><A NAME="BROYDEN_ETA"><u>BROYDEN_ETA</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">BROYDEN_ETA 0.7
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Dampening of estimated energy curvature.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default value:     6.9999999999999996E-01
<TR><TD WITDH="20%"><A NAME="BROYDEN_OMEGA"><u>BROYDEN_OMEGA</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">BROYDEN_OMEGA 1.1
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Growth limit of curvature.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default value:     1.1000000000000001E+00
<TR><TD WITDH="20%"><A NAME="BROYDEN_SIGMA_DECREASE"><u>BROYDEN_SIGMA_DECREASE</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">BROYDEN_SIGMA_DECREASE 0.7
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Reduction of curvature on bad approximation.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default value:     6.9999999999999996E-01
<TR><TD WITDH="20%"><A NAME="BROYDEN_SIGMA_MIN"><u>BROYDEN_SIGMA_MIN</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">BROYDEN_SIGMA_MIN 0.05
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Minimum adaptive curvature.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default value:     5.0000000000000003E-02
<TR><TD WITDH="20%"><A NAME="BROYDEN_FORGET_HISTORY"><u>BROYDEN_FORGET_HISTORY</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">BROYDEN_FORGET_HISTORY OFF
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Forget history on bad approximation</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical<TR><TD WIDTH="10%"><TD>This keyword behaves as a switch T
. Default value:  F
<TR><TD WITDH="20%"><A NAME="BROYDEN_ADAPTIVE_SIGMA"><u>BROYDEN_ADAPTIVE_SIGMA</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">BROYDEN_ADAPTIVE_SIGMA ON
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Enable adaptive curvature estimation</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical<TR><TD WIDTH="10%"><TD>This keyword behaves as a switch T
. Default value:  T
<TR><TD WITDH="20%"><A NAME="BROYDEN_ENABLE_FLIP"><u>BROYDEN_ENABLE_FLIP</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">BROYDEN_ENABLE_FLIP ON
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Ensure positive definite update</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical<TR><TD WIDTH="10%"><TD>This keyword behaves as a switch T
. Default value:  T
<TR><TD WITDH="20%"><A NAME="LINESEARCH"><u>LINESEARCH</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">LINESEARCH GOLD
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>1D line search algorithm to be used with the OT minimizer, in increasing order of robustness and cost. MINIMIZER CG combined with LINESEARCH GOLD should always find an electronic minimum.  Whereas the 2PNT minimizer is almost always OK, 3PNT might be needed for systems in which successive OT CG steps do not decrease the total energy.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a keyword. Default value:  2PNT
<TR><TD WIDTH="10%"><TD>  valid keywords:<ul> <li><code>NONE</code>: take fixed lenght steps</li>
<li><code>2PNT</code>: extrapolate based on 2 points</li>
<li><code>3PNT</code>: ... or on 3 points</li>
<li><code>GOLD</code>: perform 1D golden section search of the minimum (very expensive)</li>
</ul><TR><TD WIDTH="10%"><TD>variants: LINE_SEARCH<TR><TD WITDH="20%"><A NAME="STEPSIZE"><u>STEPSIZE</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">STEPSIZE 0.4
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Initial stepsize used for the line search, sometimes this parameter can be reduced to stablize DIIS or to improve the CG behavior in the first few steps. The optimal value depends on the quality of the preconditioner. A negative values leaves the choice to CP2K depending on the preconditioner.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default value:    -1.0000000000000000E+00
<TR><TD WITDH="20%"><A NAME="GOLD_TARGET"><u>GOLD_TARGET</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">GOLD_TARGET 0.1
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Target relative uncertainty in the location of the minimum for LINESEARCH GOLD</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default value:     1.0000000000000000E-02
<TR><TD WITDH="20%"><A NAME="PRECONDITIONER"><u>PRECONDITIONER</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">PRECONDITIONER FULL_ALL
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Type of preconditioner to be used with all minimization schemes. They differ in effectiveness, cost of construction, cost of application. Properly preconditioned minimization can be orders of magnitude faster than doing nothing.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a keyword. Default value:  FULL_KINETIC
<TR><TD WIDTH="10%"><TD>  valid keywords:<ul> <li><code>FULL_ALL</code>: Most effective state selective preconditioner based on diagonalization, requires the ENERGY_GAP parameter to be an underestimate of the HOMO-LUMO gap. This preconditioner is recommended for almost all systems, except very large systems where make_preconditioner would dominate the total computational cost.</li>
<li><code>FULL_SINGLE_INVERSE</code>: Based on H-eS cholesky inversion, similar to FULL_SINGLE in preconditioning efficiency but cheaper to construct, might be somewhat less robust. Recommended for large systems.</li>
<li><code>FULL_SINGLE</code>: Based on H-eS diagonalisation, not as good as FULL_ALL, but somewhat cheaper to apply.</li>
<li><code>FULL_KINETIC</code>: Cholesky inversion of S and T, fast construction, robust, and relatively good, use for very large systems.</li>
<li><code>FULL_S_INVERSE</code>: Cholesky inversion of S, not as good as FULL_KINETIC, yet equally expensive.</li>
<li><code>NONE</code>: skip preconditioning</li>
</ul><BR> This keyword cites following references: 
<A HREF="references.html#reference_39" TITLE="
 VandeVondele, J; Hutter, J. 
 JOURNAL OF CHEMICAL PHYSICS, 118 (10), 4365-4369 (2003). 
 An efficient orbital transformation method for electronic structure
 calculations.
 http://dx.doi.org/10.1063/1.1543154
">[VandeVondele2003]</A>
<A HREF="references.html#reference_20" TITLE="
 Weber, V; VandeVondele, J; Hutter, J; Niklasson, AMN. 
 JOURNAL OF CHEMICAL PHYSICS, 128 (8), 084113 (2008). 
 Direct energy functional minimization under orthogonality constraints.
 http://dx.doi.org/10.1063/1.2841077
">[Weber2008]</A>
<A HREF="references.html#reference_156" TITLE="
 Schiffmann, F; VandeVondele, J. 
 JOURNAL OF CHEMICAL PHYSICS, 142 (24), 244117 (2015). 
 Efficient preconditioning of the electronic structure problem in large
 scale ab initio molecular dynamics simulations.
 http://dx.doi.org/10.1063/1.4922988
">[Schiffmann2015]</A>
<TR><TD WITDH="20%"><A NAME="CHOLESKY"><u>CHOLESKY</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">CHOLESKY REDUCE
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>If FULL_ALL the cholesky decomposition of the S matrix is used. Options on the algorithm to be used.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a keyword. Default value:  REDUCE
<TR><TD WIDTH="10%"><TD>  valid keywords:<ul> <li><code>OFF</code>: The cholesky algorithm is not used</li>
<li><code>REDUCE</code>: Reduce is called</li>
<li><code>RESTORE</code>: Reduce is replaced by two restore</li>
<li><code>INVERSE</code>: Restore uses operator multiply by inverse of the triangular matrix</li>
<li><code>INVERSE_DBCSR</code>: Like inverse, but matrix stored as dbcsr, sparce matrix algebra used when possible</li>
</ul><TR><TD WITDH="20%"><A NAME="PRECOND_SOLVER"><u>PRECOND_SOLVER</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">PRECOND_SOLVER DIRECT
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>How the preconditioner is applied to the residual.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a keyword. Default value:  DEFAULT
<TR><TD WIDTH="10%"><TD>  valid keywords:<ul> <li><code>DEFAULT</code>: the default</li>
<li><code>DIRECT</code>: Cholesky decomposition followed by triangular solve (works for FULL_KINETIC/SINGLE_INVERSE/S_INVERSE)</li>
<li><code>INVERSE_CHOLESKY</code>: Cholesky decomposition followed by explicit inversion (works for FULL_KINETIC/SINGLE_INVERSE/S_INVERSE)</li>
<li><code>INVERSE_UPDATE</code>: Performs a Hotelling update of the inverse if a previous preconditioner is present. Mainly useful for GPU accelerated systems (works for FULL_KINETIC/SINGLE_INVERSE/S_INVERSE)</li>
</ul><TR><TD WITDH="20%"><A NAME="ENERGY_GAP"><u>ENERGY_GAP</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">ENERGY_GAP 0.001
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Should be an estimate for the energy gap [a.u.] (HOMO-LUMO) and is used in preconditioning, especially effective with the FULL_ALL preconditioner, in which case it should be an underestimate of the gap (can be a small number, e.g. 0.002). FULL_SINGLE_INVERSE takes it as lower bound (values below 0.05 can cause stability issues). In general, heigher values will tame the preconditioner in case of poor initial guesses. A negative value will leave the choice to CP2K depending on type of preconditioner.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default value:    -1.0000000000000000E+00
<TR><TD WITDH="20%"><A NAME="EPS_TAYLOR"><u>EPS_TAYLOR</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">EPS_TAYLOR 1.0E-15
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Target accuracy of the taylor expansion for the matrix functions, should normally be kept as is.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default value:     9.9999999999999998E-17
<TR><TD WIDTH="10%"><TD>variants: EPSTAYLOR<TR><TD WITDH="20%"><A NAME="MAX_TAYLOR"><u>MAX_TAYLOR</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">MAX_TAYLOR 5
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Maximum order of the Taylor expansion before diagonalisation is prefered, for large parallel runs a slightly higher order could sometimes result in a small speedup.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects an integer. Default value:  4
<TR><TD WITDH="20%"><A NAME="ROTATION"><u>ROTATION</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">ROTATION
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Introduce additional variables so that rotations of the occupied subspace are allowed as well, only needed for cases where the energy is not invariant under  a rotation of the occupied subspace such as non-singlet restricted calculations  or fractional occupations.</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical<TR><TD WIDTH="10%"><TD>This keyword behaves as a switch T
. Default value:  F
<TR><TD WITDH="20%"><A NAME="ENERGIES"><u>ENERGIES</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">ENERGIES
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Optimize orbital energies for use in Fermi-Dirac smearing (requires ROTATION and FD smearing to be active).</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical<TR><TD WIDTH="10%"><TD>This keyword behaves as a switch T
. Default value:  F
<TR><TD WITDH="20%"><A NAME="OCCUPATION_PRECONDITIONER"><u>OCCUPATION_PRECONDITIONER</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">OCCUPATION_PRECONDITIONER
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Preconditioner with the occupation numbers (FD smearing)</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical<TR><TD WIDTH="10%"><TD>This keyword behaves as a switch T
. Default value:  F
<TR><TD WITDH="20%"><A NAME="NONDIAG_ENERGY"><u>NONDIAG_ENERGY</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">NONDIAG_ENERGY
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>Add a non-diagonal energy penalty (FD smearing)</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a logical<TR><TD WIDTH="10%"><TD>This keyword behaves as a switch T
. Default value:  F
<TR><TD WITDH="20%"><A NAME="NONDIAG_ENERGY_STRENGTH"><u>NONDIAG_ENERGY_STRENGTH</u></A><TD WIDTH="80%">
<TR><TD WIDTH="20%"><TD WIDTH="80%">NONDIAG_ENERGY_STRENGTH
<TR><TD WIDTH="20%"><TD WIDTH="80%"><i>The prefactor for the non-diagonal energy penalty (FD smearing)</i>
<TR><TD WIDTH="10%"><TD> This keyword expects a real. Default value:     1.0000000000000000E+00
</TABLE>
<BR><hr>Back to the <A HREF="https://www.cp2k.org/">CP2K homepage</A> or the latest version of <A HREF="https://manual.cp2k.org/trunk/">this manual</A>
</BODY></HTML>
